<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JIIPE — Industrial Investor FAQ</title>
  <style>
    :root{--bg:#0b1220;--card:#0f1a2e;--line:#1f2a44;--text:#e9efff;--muted:#9fb0d0;--chip:#132340;--accent:#7dd3fc;}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text)}
    header{max-width:1100px;margin:0 auto;padding:36px 18px 10px}
    h1{margin:0 0 8px;font-size:30px}
    .sub{color:var(--muted);line-height:1.5;max-width:75ch}
    .bar{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    input{flex:1;min-width:240px;background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px 14px;color:var(--text);outline:none}
    main{max-width:1100px;margin:0 auto;padding:0 18px 60px}
    .meta{color:var(--muted);font-size:14px;margin:16px 2px}
    .cat{border:1px solid var(--line);background:rgba(15,26,46,.7);border-radius:16px;margin:12px 0;overflow:hidden}
    .catHead{display:flex;justify-content:space-between;gap:10px;padding:14px 14px;cursor:pointer}
    .catTitle{font-weight:650}
    .count{color:var(--muted);font-size:13px}
    .items{padding:0 8px 10px;display:none}
    .cat.open .items{display:block}
    details{border:1px solid var(--line);background:rgba(11,18,32,.55);border-radius:12px;margin:10px;overflow:hidden}
    summary{list-style:none;cursor:pointer;padding:12px 12px;display:flex;gap:10px}
    summary::-webkit-details-marker{display:none}
    .q{font-weight:650;line-height:1.35}
    .ans{padding:0 12px 12px;color:var(--text);line-height:1.55}
    .tags{display:flex;gap:6px;flex-wrap:wrap;margin-top:10px}
    .chip{font-size:12px;color:var(--muted);background:var(--chip);border:1px solid var(--line);padding:4px 8px;border-radius:999px}
    a{color:var(--accent);text-decoration:none}
  </style>
</head>
<body>
<header>
  <h1 id="title">Industrial Investor FAQ</h1>
  <div class="sub">Search and browse investor-relevant answers. Data is loaded from <code>faq.json</code>.</div>
  <div class="bar">
    <input id="search" placeholder="Search: gas price, VAT, WWTP, port, incentives, OSS, PU..." />
  </div>
</header>

<main>
  <div id="meta" class="meta"></div>
  <div id="app"></div>
</main>

<script>
  const state = { data:null, query:"" };
  const $ = (id)=>document.getElementById(id);

  function matches(item){
    const q = state.query.trim().toLowerCase();
    if(!q) return true;
    const hay = (item.q + " " + item.a + " " + (item.tags||[]).join(" ")).toLowerCase();
    return hay.includes(q);
  }

  function render(){
    const data = state.data;
    $("title").textContent = data.title || "Industrial Investor FAQ";

    const filteredCats = data.categories
      .map(c => ({...c, items: (c.items||[]).filter(matches)}))
      .filter(c => c.items.length > 0);

    const total = filteredCats.reduce((s,c)=>s+c.items.length,0);
    $("meta").textContent = `Updated: ${data.updated_at || "—"} • Showing ${total} answers`;

    const app = $("app");
    app.innerHTML = "";

    for(const cat of filteredCats){
      const sec = document.createElement("section");
      sec.className = "cat";

      const head = document.createElement("div");
      head.className = "catHead";
      head.innerHTML = `<div class="catTitle">${cat.name}</div><div class="count">${cat.items.length} Q&A</div>`;
      head.onclick = ()=>sec.classList.toggle("open");

      const items = document.createElement("div");
      items.className = "items";

      for(const it of cat.items){
        const d = document.createElement("details");
        const s = document.createElement("summary");
        s.innerHTML = `<div class="q">${it.q}</div>`;
        const a = document.createElement("div");
        a.className = "ans";
        a.textContent = it.a;

        if(it.tags && it.tags.length){
          const t = document.createElement("div");
          t.className = "tags";
          it.tags.forEach(tag=>{
            const chip = document.createElement("span");
            chip.className = "chip";
            chip.textContent = tag;
            t.appendChild(chip);
          });
          a.appendChild(t);
        }
        d.appendChild(s);
        d.appendChild(a);
        items.appendChild(d);
      }

      sec.appendChild(head);
      sec.appendChild(items);
      app.appendChild(sec);
    }
  }

  $("search").addEventListener("input", (e)=>{
    state.query = e.target.value;
    render();
  });

  async function init(){
    const res = await fetch("./faq.json", { cache: "no-store" });
    state.data = await res.json();
    render();
  }
  init();
</script>
</body>
</html>
